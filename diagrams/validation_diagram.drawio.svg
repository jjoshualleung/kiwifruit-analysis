<svg host="65bd71144e" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="881px" height="851px" viewBox="-0.5 -0.5 881 851" content="&lt;mxfile&gt;&lt;diagram id=&quot;18qgbP1cbcqimK7TuhKl&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;">
    <defs/>
    <g>
        <path d="M 567 750 L 653 750 Q 663 750 663 740 L 663 576.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/>
        <path d="M 663 571.12 L 666.5 578.12 L 663 576.37 L 659.5 578.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/>
        <rect x="327" y="730" width="240" height="120" rx="7.2" ry="7.2" fill="#63bef2" stroke="#2086c9" pointer-events="all"/>
        <g transform="translate(-0.5 -0.5)">
            <switch>
                <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 790px; margin-left: 328px;">
                        <div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
                            <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">
                                <font style="font-size: 16px">
                                    <b>
                                        Validation
                                    </b>
                                </font>
                                <div>
                                    [Spark function: PySpark]
                                </div>
                                <br/>
                                <div>
                                    <font style="font-size: 11px">
                                        Return invalid records from dataframe, if any
                                    </font>
                                </div>
                            </div>
                        </div>
                    </div>
                </foreignObject>
                <text x="447" y="794" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">
                    Validation...
                </text>
            </switch>
        </g>
        <path d="M 253 460 L 253 740 Q 253 750 263 750 L 320.63 750" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/>
        <path d="M 325.88 750 L 318.88 753.5 L 320.63 750 L 318.88 746.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/>
        <path d="M 133 355 C 133 346.72 186.73 340 253 340 C 284.83 340 315.35 341.58 337.85 344.39 C 360.36 347.21 373 351.02 373 355 L 373 445 C 373 453.28 319.27 460 253 460 C 186.73 460 133 453.28 133 445 Z" fill="#23a2d9" stroke="#0e7dad" stroke-miterlimit="10" pointer-events="all"/>
        <path d="M 373 355 C 373 363.28 319.27 370 253 370 C 186.73 370 133 363.28 133 355" fill="none" stroke="#0e7dad" stroke-miterlimit="10" pointer-events="all"/>
        <g transform="translate(-0.5 -0.5)">
            <switch>
                <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 413px; margin-left: 134px;">
                        <div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
                            <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">
                                <font style="font-size: 16px">
                                    <b>
                                        Join fruit drop cumulative weather stress
                                    </b>
                                </font>
                                <div>
                                    [Container: Spark dataframe]
                                </div>
                                <br/>
                                <div>
                                    <font style="font-size: 11px">
                                        <font color="#E6E6E6">
                                            Stores fruit drop and cumulative weather stress for each cane, bay, maturity area, KPIN at fruit drop survey
                                        </font>
                                    </font>
                                </div>
                            </div>
                        </div>
                    </div>
                </foreignObject>
                <text x="253" y="416" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">
                    Join fruit drop cumulative weather stres...
                </text>
            </switch>
        </g>
        <path d="M 663 450 L 663 396.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/>
        <path d="M 663 391.12 L 666.5 398.12 L 663 396.37 L 659.5 398.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/>
        <path d="M 543 465 C 543 456.72 596.73 450 663 450 C 694.83 450 725.35 451.58 747.85 454.39 C 770.36 457.21 783 461.02 783 465 L 783 555 C 783 563.28 729.27 570 663 570 C 596.73 570 543 563.28 543 555 Z" fill="#23a2d9" stroke="#0e7dad" stroke-miterlimit="10" pointer-events="all"/>
        <path d="M 783 465 C 783 473.28 729.27 480 663 480 C 596.73 480 543 473.28 543 465" fill="none" stroke="#0e7dad" stroke-miterlimit="10" pointer-events="all"/>
        <g transform="translate(-0.5 -0.5)">
            <switch>
                <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 523px; margin-left: 544px;">
                        <div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
                            <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">
                                <font style="font-size: 16px">
                                    <b>
                                        Subset of invalid join fruit drop cumulative weather stress
                                    </b>
                                </font>
                                <div>
                                    [Container: Spark dataframe]
                                </div>
                                <br/>
                                <div>
                                    <font style="font-size: 11px">
                                        <font color="#E6E6E6"></font>
                                    </font>
                                </div>
                            </div>
                        </div>
                    </div>
                </foreignObject>
                <text x="663" y="526" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">
                    Subset of invalid join fruit drop cumula...
                </text>
            </switch>
        </g>
        <rect x="0" y="0" width="880" height="670" rx="10" ry="10" fill="none" stroke="#666666" stroke-dasharray="8 4" pointer-events="none"/>
        <g transform="translate(-0.5 -0.5)">
            <switch>
                <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 862px; height: 1px; padding-top: 659px; margin-left: 10px;">
                        <div data-drawio-colors="color: #333333; " style="box-sizing: border-box; font-size: 0px; text-align: left;">
                            <div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">
                                <font style="font-size: 16px">
                                    <b>
                                        <div style="text-align: left">
                                            Notebook
                                        </div>
                                    </b>
                                </font>
                                <div style="text-align: left">
                                    [Container]
                                </div>
                            </div>
                        </div>
                    </div>
                </foreignObject>
                <text x="10" y="659" fill="#333333" font-family="Helvetica" font-size="11px">
                    Notebook...
                </text>
            </switch>
        </g>
        <path d="M 663 270 L 663 196.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/>
        <path d="M 663 191.12 L 666.5 198.12 L 663 196.37 L 659.5 198.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/>
        <rect x="543" y="270" width="240" height="120" rx="12" ry="12" fill="#23a2d9" stroke="#0e7dad" pointer-events="none"/>
        <g transform="translate(-0.5 -0.5)">
            <switch>
                <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 330px; margin-left: 544px;">
                        <div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
                            <div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">
                                <font style="font-size: 16px">
                                    <b>
                                        Show the subset of invalid records
                                    </b>
                                </font>
                                <div>
                                    [Container: Spark dataframe]
                                </div>
                                <br/>
                                <div>
                                    <font style="font-size: 11px">
                                        <font color="#E6E6E6"></font>
                                    </font>
                                </div>
                            </div>
                        </div>
                    </div>
                </foreignObject>
                <text x="663" y="333" fill="#ffffff" font-family="Helvetica" font-size="11px" text-anchor="middle">
                    Show the subset of invalid records...
                </text>
            </switch>
        </g>
        <rect x="543" y="70" width="240" height="120" rx="7.2" ry="7.2" fill="#63bef2" stroke="#2086c9" pointer-events="none"/>
        <g transform="translate(-0.5 -0.5)">
            <switch>
                <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 130px; margin-left: 544px;">
                        <div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
                            <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">
                                <font style="font-size: 16px">
                                    <b>
                                        Raise exception if invalid record dataframe is not empty
                                    </b>
                                </font>
                                <div>
                                    [Spark function: PySpark]
                                </div>
                                <br/>
                                <div>
                                    <font style="font-size: 11px">
                                        Raise error if the dataframe contains invalid rows
                                    </font>
                                </div>
                            </div>
                        </div>
                    </div>
                </foreignObject>
                <text x="663" y="134" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">
                    Raise exception if invalid record datafr...
                </text>
            </switch>
        </g>
    </g>
    <switch>
        <g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/>
        <a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank">
            <text text-anchor="middle" font-size="10px" x="50%" y="100%">
                Text is not SVG - cannot display
            </text>
        </a>
    </switch>
</svg>